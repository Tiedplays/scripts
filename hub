-- =====================
-- Services
-- =====================
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Stats = game:GetService("Stats")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local ICON_ID = "rbxassetid://118551308102810"

-- =====================
-- MAIN UI (UNCHANGED)
-- =====================
local gui = Instance.new("ScreenGui")
gui.Name = "ZenithFansPremiumUI"
gui.IgnoreGuiInset = true
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

-- Main Bar
local bar = Instance.new("Frame")
bar.Size = UDim2.new(0, 620, 0, 62)
bar.Position = UDim2.new(0.5, -310, 1, -130)
bar.BackgroundColor3 = Color3.fromRGB(10, 10, 12)
bar.BackgroundTransparency = 0.25
bar.BorderSizePixel = 0
bar.Parent = gui
Instance.new("UICorner", bar).CornerRadius = UDim.new(0, 18)

-- Nebula Outline
local stroke = Instance.new("UIStroke", bar)
stroke.Thickness = 2
stroke.Color = Color3.fromRGB(170, 90, 255)

local strokeGradient = Instance.new("UIGradient", stroke)
strokeGradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(150, 90, 255)),
	ColorSequenceKeypoint.new(0.25, Color3.fromRGB(90, 180, 255)),
	ColorSequenceKeypoint.new(0.5, Color3.fromRGB(200, 90, 255)),
	ColorSequenceKeypoint.new(0.75, Color3.fromRGB(90, 180, 255)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(150, 90, 255))
}
strokeGradient.Rotation = 0

-- Padding
local pad = Instance.new("UIPadding")
pad.PaddingLeft = UDim.new(0, 16)
pad.PaddingRight = UDim.new(0, 16)
pad.PaddingTop = UDim.new(0, 8)
pad.PaddingBottom = UDim.new(0, 8)
pad.Parent = bar

-- ICON
local logo = Instance.new("ImageLabel")
logo.Image = ICON_ID
logo.Size = UDim2.new(0, 30, 0, 30)
logo.Position = UDim2.new(0, 0, 0.5, -15)
logo.BackgroundTransparency = 1
logo.Parent = bar

local gradientOverlay = Instance.new("UIGradient")
gradientOverlay.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(210, 170, 255)),
	ColorSequenceKeypoint.new(0.5, Color3.fromRGB(90, 180, 255)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(210, 170, 255))
}
gradientOverlay.Rotation = 0
gradientOverlay.Parent = logo

-- Title Text
local title = Instance.new("TextLabel")
title.Text = "Zenith Fans Premium"
title.Font = Enum.Font.GothamBold
title.TextSize = 18
title.TextColor3 = Color3.fromRGB(210, 170, 255)
title.BackgroundTransparency = 1
title.Position = UDim2.new(0, 38, 0, -2)
title.Size = UDim2.new(0, 260, 0.55, 0)
title.TextXAlignment = Enum.TextXAlignment.Left
title.TextYAlignment = Enum.TextYAlignment.Center
title.Parent = bar

local subtitle = Instance.new("TextLabel")
subtitle.Text = "by @tiedplays_yt | discord.gg/8YMAN3SnQc"
subtitle.Font = Enum.Font.Gotham
subtitle.TextSize = 14
subtitle.TextColor3 = Color3.fromRGB(200, 200, 210)
subtitle.BackgroundTransparency = 1
subtitle.Position = UDim2.new(0, 38, 0.45, 0)
subtitle.Size = UDim2.new(0, 360, 0.55, 0)
subtitle.TextXAlignment = Enum.TextXAlignment.Left
subtitle.TextYAlignment = Enum.TextYAlignment.Center
subtitle.Parent = bar

-- Right Stats
local right = Instance.new("Frame")
right.Size = UDim2.new(0, 230, 1, 0)
right.Position = UDim2.new(1, -230, 0, 0)
right.BackgroundTransparency = 1
right.Parent = bar

local layout = Instance.new("UIListLayout", right)
layout.FillDirection = Enum.FillDirection.Vertical
layout.HorizontalAlignment = Enum.HorizontalAlignment.Right
layout.VerticalAlignment = Enum.VerticalAlignment.Center
layout.Padding = UDim.new(0, 2)

local hint = Instance.new("TextLabel")
hint.Text = "Hide/Open Settings : T"
hint.Font = Enum.Font.GothamBold
hint.TextSize = 14
hint.TextColor3 = Color3.fromRGB(235, 235, 255)
hint.BackgroundTransparency = 1
hint.Size = UDim2.new(1, 0, 0.5, 0)
hint.TextXAlignment = Enum.TextXAlignment.Right
hint.Parent = right

local statsLabel = Instance.new("TextLabel")
statsLabel.Text = "FPS: 0    PING: 0ms"
statsLabel.Font = Enum.Font.GothamBold
statsLabel.TextSize = 14
statsLabel.TextColor3 = Color3.fromRGB(235, 235, 255)
statsLabel.BackgroundTransparency = 1
statsLabel.Size = UDim2.new(1, 0, 0.5, 0)
statsLabel.TextXAlignment = Enum.TextXAlignment.Right
statsLabel.Parent = right

-- FPS / Ping updater
local frames = 0
local last = os.clock()
RunService.RenderStepped:Connect(function()
	frames += 1
	if os.clock() - last >= 1 then
		local ping = math.floor(Stats.Network.ServerStatsItem["Data Ping"]:GetValue())
		statsLabel.Text = "FPS: " .. frames .. "    PING: " .. ping .. "ms"
		frames = 0
		last = os.clock()
	end
end)

-- Gradient Rotation
spawn(function()
	local angle = 0
	while true do
		angle += 1
		strokeGradient.Rotation = angle
		gradientOverlay.Rotation = angle
		RunService.RenderStepped:Wait()
	end
end)

-- =====================
-- Toggle UI
-- =====================
local toggleUI = Instance.new("Frame")
toggleUI.Size = UDim2.new(0, 750, 0, 480)
toggleUI.Position = UDim2.new(0.5, -375, 0.5, -240)
toggleUI.BorderSizePixel = 0
toggleUI.Visible = false
toggleUI.BackgroundColor3 = Color3.fromRGB(5,5,15)
toggleUI.BackgroundTransparency = 0.15
toggleUI.Parent = gui
Instance.new("UICorner", toggleUI).CornerRadius = UDim.new(0,18)

-- ✅ Purple Outline Added
local toggleStroke = Instance.new("UIStroke")
toggleStroke.Thickness = 2
toggleStroke.Color = Color3.fromRGB(170, 90, 255)
toggleStroke.Parent = toggleUI

-- Make toggleUI draggable
do
	local dragging, dragInput, mousePos, framePos
	toggleUI.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			mousePos = input.Position
			framePos = toggleUI.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragging = false
				end
			end)
		end
	end)
	toggleUI.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement then
			dragInput = input
		end
	end)
	UserInputService.InputChanged:Connect(function(input)
		if input == dragInput and dragging then
			local delta = input.Position - mousePos
			toggleUI.Position = UDim2.new(framePos.X.Scale, framePos.X.Offset + delta.X,
				framePos.Y.Scale, framePos.Y.Offset + delta.Y)
		end
	end)
end

-- Nebula Background Gradient
local nebulaGradient = Instance.new("UIGradient")
nebulaGradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(15,0,30)),
	ColorSequenceKeypoint.new(0.3, Color3.fromRGB(30,0,50)),
	ColorSequenceKeypoint.new(0.6, Color3.fromRGB(10,0,40)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(0,0,25))
}
nebulaGradient.Rotation = 45
nebulaGradient.Parent = toggleUI

-- Star Layer
local starLayer = Instance.new("Frame")
starLayer.Size = UDim2.new(1,0,1,0)
starLayer.BackgroundTransparency = 1
starLayer.ZIndex = 0
starLayer.Parent = toggleUI

local stars = {}
for i = 1,150 do
	local star = Instance.new("Frame")
	star.Size = UDim2.new(0,1,0,1)
	star.Position = UDim2.new(math.random(),0,math.random(),0)
	star.BackgroundColor3 = Color3.fromRGB(
		math.random(150,255),
		math.random(150,200),
		math.random(220,255)
	)
	star.BackgroundTransparency = math.random()*0.8
	star.BorderSizePixel = 0
	star.Parent = starLayer
	table.insert(stars, star)
end

-- Move stars continuously
RunService.RenderStepped:Connect(function()
	for _,p in ipairs(stars) do
		local x = (p.Position.X.Scale + math.random()*0.0006) % 1
		local y = (p.Position.Y.Scale + math.random()*0.0006) % 1
		p.Position = UDim2.new(x,0,y,0)
	end
end)

-- Toggle Title
local toggleTitle = Instance.new("TextLabel")
toggleTitle.Text = "ZENITH FANS PREMIUM"
toggleTitle.Font = Enum.Font.GothamBold
toggleTitle.TextSize = 34
toggleTitle.TextColor3 = Color3.fromRGB(215,185,255)
toggleTitle.BackgroundTransparency = 1
toggleTitle.Size = UDim2.new(1,0,0,50)
toggleTitle.Position = UDim2.new(0,0,0,12)
toggleTitle.TextXAlignment = Enum.TextXAlignment.Center
toggleTitle.Parent = toggleUI

-- Tabs Frame
local tabsFrame = Instance.new("Frame")
tabsFrame.Size = UDim2.new(0.22,0,0.85,-20)
tabsFrame.Position = UDim2.new(0,10,0,75)
tabsFrame.BackgroundTransparency = 1
tabsFrame.Parent = toggleUI

local tabsLayout = Instance.new("UIListLayout", tabsFrame)
tabsLayout.Padding = UDim.new(0,6)

-- Panel Container
local panelContainer = Instance.new("Frame")
panelContainer.Size = UDim2.new(0.75,-20,0.85,-20)
panelContainer.Position = UDim2.new(0.25,10,0,75)
panelContainer.BackgroundTransparency = 1
panelContainer.BorderSizePixel = 0
panelContainer.Parent = toggleUI

-- Tabs + Panels
local tabNames = {"OPTIMIZER","MAIN","VISUALS","HELPER","SPEED","CHARACTER","DISCORD"}
local tabButtons = {}
local tabPanels = {}
local highlightBoxes = {}

local activeTabIndex = 1

for i,name in ipairs(tabNames) do
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(1,0,0,42)
	btn.Text = name
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 14
	btn.TextColor3 = Color3.fromRGB(210,170,255)
	btn.BackgroundTransparency = 1
	btn.AutoButtonColor = false
	btn.ZIndex = 2
	btn.Parent = tabsFrame

	local panel = Instance.new("Frame")
	panel.Size = UDim2.new(1,-10,1,-10)
	panel.Position = UDim2.new(0,5,0,5)
	panel.BackgroundTransparency = 1
	panel.Visible = false
	panel.Parent = panelContainer

	-- Highlight box
	local box = Instance.new("Frame")
	box.Size = UDim2.new(1,0,1,0)
	box.Position = UDim2.new(0,0,0,0)
	box.BackgroundColor3 = Color3.fromRGB(0,0,0)
	box.BackgroundTransparency = 0.6
	box.BorderSizePixel = 0
	box.Visible = false
	box.ZIndex = 1
	box.Parent = btn
	Instance.new("UICorner", box).CornerRadius = UDim.new(0,10)

	local stroke = Instance.new("UIStroke", box)
	stroke.Thickness = 2
	local grad = Instance.new("UIGradient", stroke)
	grad.Color = ColorSequence.new{
		ColorSequenceKeypoint.new(0, Color3.fromRGB(170,110,255)),
		ColorSequenceKeypoint.new(0.5, Color3.fromRGB(90,180,255)),
		ColorSequenceKeypoint.new(1, Color3.fromRGB(170,110,255))
	}

	-- Gradient rotation
	task.spawn(function()
		local r = 0
		while true do
			r = (r + 0.6) % 360
			grad.Rotation = r
			RunService.RenderStepped:Wait()
		end
	end)

	-- ✅ FIXED TAB CLICK LOGIC
	btn.MouseButton1Click:Connect(function()

		-- Hide old highlight
		local oldBox = highlightBoxes[activeTabIndex]
		if oldBox then
			local fadeOut = TweenService:Create(oldBox, TweenInfo.new(0.25), {BackgroundTransparency = 1})
			fadeOut:Play()
			fadeOut.Completed:Connect(function()
				oldBox.Visible = false
			end)
		end

		tabButtons[activeTabIndex].TextColor3 = Color3.fromRGB(210,170,255)
		tabButtons[activeTabIndex].TextSize = 14

		activeTabIndex = i

		for j,p in ipairs(tabPanels) do
			p.Visible = (j == i)
		end

		-- Show new highlight
		box.Visible = true
		box.BackgroundTransparency = 1

		local fadeIn = TweenService:Create(box, TweenInfo.new(0.3), {BackgroundTransparency = 0.6})
		fadeIn:Play()

		btn.TextColor3 = Color3.fromRGB(240,240,255)
		btn.TextSize = 16
	end)

	table.insert(tabButtons, btn)
	table.insert(tabPanels, panel)
	table.insert(highlightBoxes, box)
end

-- Set first tab active
tabPanels[1].Visible = true
highlightBoxes[1].Visible = true
tabButtons[1].TextColor3 = Color3.fromRGB(240,240,255)
tabButtons[1].TextSize = 16

-- =====================
-- Toggle Animation
-- =====================
local defaultSize = toggleUI.Size
toggleUI.Size = UDim2.new(0,1,0,1)

local function toggleAnimation(show)
	if show then
		toggleUI.Visible = true
		TweenService:Create(toggleUI,TweenInfo.new(0.35),{Size=defaultSize}):Play()
	else
		local t = TweenService:Create(toggleUI,TweenInfo.new(0.25),{Size=UDim2.new(0,1,0,1)})
		t:Play()
		t.Completed:Connect(function()
			toggleUI.Visible = false
		end)
	end
end

UserInputService.InputBegan:Connect(function(i,gp)
	if gp then return end
	if i.KeyCode == Enum.KeyCode.T then
		toggleAnimation(not toggleUI.Visible)
	end
end)
